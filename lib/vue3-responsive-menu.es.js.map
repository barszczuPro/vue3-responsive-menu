{"version":3,"file":"vue3-responsive-menu.es.js","sources":["../node_modules/uid/dist/index.mjs","../library/ResponsiveMenu.vue","../library/ResponsiveMenuInstance.ts"],"sourcesContent":["var IDX=256, HEX=[], SIZE=256, BUFFER;\nwhile (IDX--) HEX[IDX] = (IDX + 256).toString(16).substring(1);\n\nexport function uid(len) {\n\tvar i=0, tmp=(len || 11);\n\tif (!BUFFER || ((IDX + tmp) > SIZE*2)) {\n\t\tfor (BUFFER='',IDX=0; i < SIZE; i++) {\n\t\t\tBUFFER += HEX[Math.random() * 256 | 0];\n\t\t}\n\t}\n\n\treturn BUFFER.substring(IDX, IDX++ + tmp);\n}\n","<template>\n  <nav\n      ref=\"itemsRefs\"\n      :class=\"[{ [`responsive-menu-${config.mode}`]: config.mode }, 'responsive-menu']\"\n  >\n    <ul class=\"responsive-menu__items\">\n      <li\n          :class=\"['responsive-menu__item', { 'responsive-menu__item-submenu': item.childs?.length }]\"\n          :data-rmenu-id=\"item.id\"\n          v-for=\"(item, key) in responsiveMenuMain\"\n          :key=\"key\"\n          ref=\"itemRefs\"\n      >\n        {{ item.label }}\n        <span></span>\n        <ul v-if=\"item.childs\" class=\"responsive-menu__submenu-items\">\n          <li\n              v-for=\"(item, key) in responsiveMenuChilds(item.id)\"\n              class=\"responsive-menu__submenu-item\"\n              :key=\"key\"\n          >\n            {{ item.label }}\n          </li>\n        </ul>\n      </li>\n      <li\n          :class=\"[\n          'responsive-menu__more',\n          { 'responsive-menu__more-disabled': !responsiveMenuMore.length }\n        ]\"\n          ref=\"itemMoreRef\"\n      >\n        {{ config.labelMore }}\n        <span></span>\n        <ul class=\"responsive-menu__submenu-items\">\n          <li\n              v-for=\"(item, key) in responsiveMenuMore\"\n              class=\"responsive-menu__submenu-item\"\n              :key=\"key\"\n          >\n            {{ item.label }}\n          </li>\n        </ul>\n      </li>\n    </ul>\n  </nav>\n</template>\n\n<script lang=\"ts\" setup>\nimport {computed, nextTick, ref} from 'vue'\nimport type {PropType} from 'vue'\nimport {uid} from 'uid'\nimport type {MenuItem, Config} from './ResponsiveMenuDefine'\n\nconst props = defineProps({\n  items: {\n    type: Array<MenuItem>,\n    default: () => []\n  },\n  config: {\n    type: Object as PropType<Config>,\n    default: () => ({\n      labelMore: 'More',\n      mode: ''\n    })\n  }\n})\n\nconst itemRefs = ref<HTMLElement[]>([])\nconst itemsRefs = ref<HTMLElement | null>(null)\nconst itemMoreRef = ref<HTMLElement | null>(null)\n\nconst responsiveMenu = ref([])\nconst resizeMenuItems = ref([])\nconst responsiveMenuMap = computed(() =>\n  resizeMenuItems.value.map((item) => ({[item.id]: item})).reduce((x, y) => ({...x, ...y}))\n)\n\nconst responsiveMenuMain = computed(() =>\n  resizeMenuItems.value.length\n    ? resizeMenuItems.value.filter((item) => !item.parent && !item.showMore)\n    : responsiveMenu.value\n)\nconst responsiveMenuMore = computed(() =>\n  resizeMenuItems.value.filter((item) => {\n    if (item.wrapSubmenu) {\n      return item.parent && responsiveMenuMap.value[item.parent]?.showMore\n    }\n    return item.showMore\n  })\n)\n\nconst responsiveMenuChilds = (id) => resizeMenuItems.value.filter((item) => item.parent === id)\n\nfunction prepareItems(menu, parentId = null, nextElement = false, wrapSubmenu = false) {\n  const result = []\n  menu.forEach((item, index) => {\n    const id = uid(6)\n    const nextEL =\n      index < menu.length - 1 ? prepareItems([menu[index + 1]], null, true)[0].id : null\n    const transformedItem = {\n      ...item,\n      id,\n      ...(wrapSubmenu && {wrapSubmenu}),\n      ...(nextEL && {nextEL}),\n      ...(parentId && {parent: parentId}),\n      ...(item.submenu && {\n        childs: item.submenu.map((submenuItem) => {\n          const transformedSubmenuItem = prepareItems([submenuItem], id, false, item.wrapSubmenu)[0]\n          result.push(transformedSubmenuItem)\n          return transformedSubmenuItem.id\n        })\n      })\n    }\n    if (transformedItem.childs && item.submenu) {\n      delete transformedItem.submenu\n    }\n    result.push(transformedItem)\n    if (item.submenu && nextElement) {\n      const transformedSubMenu = prepareItems(item.submenu, id)\n      result.push(...transformedSubMenu)\n    }\n  })\n  return result\n}\n\nconst getItemElementByDataRef = (id: number) =>\n  itemRefs.value.find((item) => item.dataset.rmenuId === id)\n\nconst calculateMenu = () => {\n  let submenuIds = responsiveMenu.value\n    .filter((item) => item.childs && item.id && !item.wrap && !item.wrapSubmenu)\n    .map((it) => it.id)\n  let breakpointHide = 0\n\n  function deleteSubmenuArr(id) {\n    const index = submenuIds.indexOf(id)\n    if (index !== -1) {\n      submenuIds.splice(index, 1)\n    }\n    return submenuIds\n  }\n\n  return responsiveMenu.value.map((el) => {\n    if (!el.parent) {\n      const offset = getItemElementByDataRef(el.id)?.offsetWidth\n      const addSubmenus = submenuIds.reduce(\n        (acc, current) => acc + getItemElementByDataRef(current)?.offsetWidth,\n        0\n      )\n      breakpointHide = breakpointHide + offset\n      const breakpointHideAndSubmenus = breakpointHide + addSubmenus\n      if (el.childs) {\n        submenuIds = deleteSubmenuArr(el.id)\n      }\n      return {...el, ...{offset, breakpointHide: breakpointHideAndSubmenus}}\n    } else {\n      return el\n    }\n  })\n}\n\nconst resizeMenu = () => {\n  const itemsOffsetWidth = itemsRefs.value?.offsetWidth\n  resizeMenuItems.value = responsiveMenu.value.map((item) => {\n    let showMore = false\n    if (!item.childs?.length) {\n      showMore = itemsOffsetWidth < item.breakpointHide + itemMoreRef.value?.offsetWidth\n    }\n    if (item.childs?.length && (item.wrap || item.wrapSubmenu)) {\n      showMore = itemsOffsetWidth < item.breakpointHide + itemMoreRef.value?.offsetWidth\n    }\n    return {...item, showMore: !item.parent && showMore}\n  })\n}\n\nconst initMenu = () => {\n  responsiveMenu.value = prepareItems(props.items)\n  nextTick(() => {\n    responsiveMenu.value = calculateMenu()\n    resizeMenu()\n    window.addEventListener('resize', resizeMenu)\n  })\n}\n\ninitMenu()\n</script>\n\n<style lang=\"scss\">\n@import './style.scss';\n</style>\n","import type { App } from 'vue'\nimport ResponsiveMenu from './ResponsiveMenu.vue'\n\nexport default {\n  install(app: App<Element>): void {\n    app.component('ResponsiveMenu', ResponsiveMenu)\n  }\n}\n"],"names":["IDX","HEX","SIZE","BUFFER","uid","len","i","tmp","props","__props","itemRefs","ref","itemsRefs","itemMoreRef","responsiveMenu","resizeMenuItems","responsiveMenuMap","computed","item","x","y","responsiveMenuMain","responsiveMenuMore","_a","responsiveMenuChilds","id","prepareItems","menu","parentId","nextElement","wrapSubmenu","result","index","nextEL","transformedItem","submenuItem","transformedSubmenuItem","transformedSubMenu","getItemElementByDataRef","calculateMenu","submenuIds","it","breakpointHide","deleteSubmenuArr","el","offset","addSubmenus","acc","current","breakpointHideAndSubmenus","resizeMenu","itemsOffsetWidth","showMore","_b","_c","_d","nextTick","Instance","app","ResponsiveMenu"],"mappings":"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","x_google_ignoreList":[0]}